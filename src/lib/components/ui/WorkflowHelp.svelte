<script lang="ts">
	let { isOpen = $bindable(false), contentType = 'workflow' } = $props();

	function closeModal() {
		isOpen = false;
	}
</script>

{#if isOpen}
	<div class="modal modal-open">
		<div class="modal-box w-11/12 max-w-4xl">
			{#if contentType === 'api-keys'}
				<h3 class="mb-4 text-lg font-bold">ğŸ”‘ API Key Verwaltung & Dokumentation</h3>
			{:else}
				<h3 class="mb-4 text-lg font-bold">ğŸ”„ Wunsch-Workflow & Prozessbeschreibung</h3>
			{/if}

			<div class="space-y-6">
				{#if contentType === 'api-keys'}
					<!-- API Keys Help Content -->
					<!-- API Overview -->
					<div class="alert alert-info">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							fill="none"
							viewBox="0 0 24 24"
							class="h-6 w-6 shrink-0 stroke-current"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								stroke-width="2"
								d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
							></path>
						</svg>
						<div>
							<h4 class="font-bold">API Key System:</h4>
							<p>
								Verwalten Sie sichere ZugriffsschlÃ¼ssel fÃ¼r externe Anwendungen und Services, die
								auf die Ã¶ffentlichen WishFactory-Endpoints zugreifen mÃ¶chten.
							</p>
						</div>
					</div>

					<!-- API Key Actions -->
					<div class="space-y-4">
						<h4 class="border-base-300 border-b pb-2 text-lg font-semibold">
							ğŸ› ï¸ VerfÃ¼gbare Aktionen
						</h4>

						<!-- Create -->
						<div class="card bg-base-100 border-primary/20 border">
							<div class="card-body">
								<div class="mb-2 flex items-center gap-3">
									<div class="badge badge-primary">Erstellen</div>
									<h5 class="text-primary font-bold">ğŸ†• Neuen API Key erstellen</h5>
								</div>
								<div class="space-y-1 text-sm">
									<p>
										<strong>Verwendung:</strong> Erstellen Sie neue API-ZugriffsschlÃ¼ssel fÃ¼r Anwendungen
									</p>
									<p><strong>Konfiguration:</strong> Name, Beschreibung, Rate Limit, Ablaufdatum</p>
									<p>
										<strong>Sicherheit:</strong> Key wird nur einmal angezeigt - sicher speichern!
									</p>
									<p>
										<strong>Standard Rate Limit:</strong> 1000 Anfragen pro Stunde (anpassbar: 1-10.000)
									</p>
								</div>
							</div>
						</div>

						<!-- Edit -->
						<div class="card bg-base-100 border-info/20 border">
							<div class="card-body">
								<div class="mb-2 flex items-center gap-3">
									<div class="badge badge-ghost">Bearbeiten</div>
									<h5 class="text-info font-bold">âœï¸ API Key bearbeiten</h5>
								</div>
								<div class="space-y-1 text-sm">
									<p>
										<strong>Anpassbare Einstellungen:</strong> Rate Limit, Beschreibung, Ablaufdatum
									</p>
									<p><strong>Rate Limit:</strong> 1-10.000 Anfragen pro Stunde</p>
									<p>
										<strong>Hinweis:</strong> Name und SchlÃ¼ssel selbst kÃ¶nnen nicht geÃ¤ndert werden
									</p>
									<p>
										<strong>Sofortige Wirkung:</strong> Ã„nderungen gelten umgehend fÃ¼r alle Anfragen
									</p>
								</div>
							</div>
						</div>

						<!-- Activate/Deactivate -->
						<div class="card bg-base-100 border-warning/20 border">
							<div class="card-body">
								<div class="mb-2 flex items-center gap-3">
									<div class="badge badge-warning">Aktivieren/Deaktivieren</div>
									<h5 class="text-warning font-bold">ğŸ”„ Status Ã¤ndern</h5>
								</div>
								<div class="space-y-1 text-sm">
									<p>
										<strong>Deaktivieren:</strong> API Key wird temporÃ¤r gesperrt (reversibel)
									</p>
									<p>
										<strong>Aktivieren:</strong> Gesperrte API Keys wieder funktionsfÃ¤hig machen
									</p>
									<p><strong>Verwendung:</strong> Sicherheitszwecke, temporÃ¤re Sperrung</p>
									<p><strong>Status:</strong> Aktiv = GrÃ¼n, Inaktiv = Rot, Abgelaufen = Orange</p>
								</div>
							</div>
						</div>

						<!-- Delete -->
						<div class="card bg-base-100 border-error/20 border">
							<div class="card-body">
								<div class="mb-2 flex items-center gap-3">
									<div class="badge badge-error">LÃ¶schen</div>
									<h5 class="text-error font-bold">ğŸ—‘ï¸ API Key lÃ¶schen</h5>
								</div>
								<div class="space-y-1 text-sm">
									<p>
										<strong>âš ï¸ Permanent:</strong> GelÃ¶schte API Keys kÃ¶nnen nicht wiederhergestellt
										werden
									</p>
									<p>
										<strong>Sofortige Wirkung:</strong> Alle Anfragen mit diesem Key werden abgelehnt
									</p>
									<p><strong>Sicherheit:</strong> Doppelte BestÃ¤tigung erforderlich</p>
									<p>
										<strong>Alternative:</strong> Verwenden Sie "Deaktivieren" fÃ¼r temporÃ¤re Sperrung
									</p>
								</div>
							</div>
						</div>
					</div>

					<!-- API Usage -->
					<div class="space-y-4">
						<h4 class="border-base-300 border-b pb-2 text-lg font-semibold">ğŸ“¡ API Verwendung</h4>

						<div class="space-y-3">
							<!-- Endpoint Information -->
							<div class="alert alert-success">
								<svg
									xmlns="http://www.w3.org/2000/svg"
									fill="none"
									viewBox="0 0 24 24"
									class="h-6 w-6 shrink-0 stroke-current"
								>
									<path
										stroke-linecap="round"
										stroke-linejoin="round"
										stroke-width="2"
										d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
									></path>
								</svg>
								<div class="text-sm">
									<h5 class="font-bold">VerfÃ¼gbare Endpoints:</h5>
									<p><strong>Wishes:</strong> GET /api/public/wishes</p>
									<p><strong>Wish Details:</strong> GET /api/public/wishes/[id]</p>
									<p><strong>Metadata:</strong> GET /api/public/wishes/metadata</p>
								</div>
							</div>

							<!-- Authentication Methods -->
							<div class="grid grid-cols-1 gap-4 md:grid-cols-2">
								<div class="card bg-base-100 border">
									<div class="card-body p-4">
										<h5 class="font-bold">ğŸ” Authentication Methode 1:</h5>
										<div class="mockup-code text-xs">
											<pre><code>X-API-Key: wsk_xxxxxxxx...</code></pre>
										</div>
									</div>
								</div>
								<div class="card bg-base-100 border">
									<div class="card-body p-4">
										<h5 class="font-bold">ğŸ” Authentication Methode 2:</h5>
										<div class="mockup-code text-xs">
											<pre><code>Authorization: Bearer wsk_xxxxxxxx...</code></pre>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<!-- Rate Limiting -->
					<div class="space-y-4">
						<h4 class="border-base-300 border-b pb-2 text-lg font-semibold">âš¡ Rate Limiting</h4>

						<div class="grid grid-cols-1 gap-4 md:grid-cols-3">
							<div class="card bg-success/5 border-success/20 border">
								<div class="card-body p-4">
									<h5 class="text-success font-bold">âœ… Normaler Betrieb</h5>
									<p class="text-sm">
										Anfragen unter dem konfigurierten Limit werden normal bearbeitet.
									</p>
								</div>
							</div>
							<div class="card bg-warning/5 border-warning/20 border">
								<div class="card-body p-4">
									<h5 class="text-warning font-bold">âš ï¸ Limit erreicht</h5>
									<p class="text-sm">HTTP 429 - Too Many Requests wird zurÃ¼ckgegeben.</p>
								</div>
							</div>
							<div class="card bg-info/5 border-info/20 border">
								<div class="card-body p-4">
									<h5 class="text-info font-bold">ğŸ”„ ZurÃ¼cksetzung</h5>
									<p class="text-sm">Rate Limit wird jede Stunde zurÃ¼ckgesetzt.</p>
								</div>
							</div>
						</div>
					</div>

					<!-- Security & Best Practices -->
					<div class="space-y-4">
						<h4 class="border-base-300 border-b pb-2 text-lg font-semibold">
							ğŸ”’ Sicherheit & Best Practices
						</h4>

						<div class="grid grid-cols-1 gap-4 md:grid-cols-2">
							<div>
								<h5 class="text-success mb-2 font-semibold">âœ… Empfohlenes Vorgehen:</h5>
								<ul class="space-y-1 text-sm">
									<li>â€¢ API Keys sicher speichern (nie in Code einbetten)</li>
									<li>â€¢ Beschreibende Namen fÃ¼r bessere Ãœbersicht</li>
									<li>â€¢ Rate Limits entsprechend der Nutzung setzen</li>
									<li>â€¢ Ablaufdatum fÃ¼r erhÃ¶hte Sicherheit</li>
									<li>â€¢ RegelmÃ¤ÃŸige ÃœberprÃ¼fung und Rotation</li>
									<li>â€¢ Deaktivierung statt LÃ¶schung bei Unsicherheit</li>
								</ul>
							</div>
							<div>
								<h5 class="text-error mb-2 font-semibold">âŒ Zu vermeiden:</h5>
								<ul class="space-y-1 text-sm">
									<li>â€¢ API Keys in Ã¶ffentlichen Repositories</li>
									<li>â€¢ ÃœbermÃ¤ÃŸig hohe Rate Limits ohne Bedarf</li>
									<li>â€¢ Teilen von API Keys zwischen Anwendungen</li>
									<li>â€¢ Unbegrenzte GÃ¼ltigkeitsdauer</li>
									<li>â€¢ Keine Ãœberwachung der Nutzungsstatistiken</li>
									<li>â€¢ Sofortiges LÃ¶schen bei Problemen</li>
								</ul>
							</div>
						</div>
					</div>
				{:else}
					<!-- Workflow Overview -->
					<div class="alert alert-info">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							fill="none"
							viewBox="0 0 24 24"
							class="h-6 w-6 shrink-0 stroke-current"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								stroke-width="2"
								d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
							></path>
						</svg>
						<div>
							<h4 class="font-bold">Gesamtprozess:</h4>
							<p>
								WÃ¼nsche durchlaufen einen strukturierten Workflow von der Erstellung bis zur
								VerÃ¶ffentlichung in WishSnap.
							</p>
						</div>
					</div>

					<!-- Workflow Steps -->
					<div class="space-y-4">
						<h4 class="border-base-300 border-b pb-2 text-lg font-semibold">
							ğŸ“‹ Workflow-Schritte
						</h4>

						<!-- Step 1: Entwurf -->
						<div class="card bg-base-100 border-warning/20 border">
							<div class="card-body">
								<div class="mb-2 flex items-center gap-3">
									<div class="badge badge-warning">1</div>
									<h5 class="text-warning font-bold">ğŸ“ Entwurf</h5>
								</div>
								<p class="mb-3 text-sm">
									<strong>Zweck:</strong> Erstellung und Bearbeitung von WÃ¼nschen
								</p>
								<div class="space-y-1 text-sm">
									<p><strong>Berechtigung:</strong> Redakteure & Administratoren</p>
									<p><strong>Aktionen:</strong> Erstellen, Bearbeiten, LÃ¶schen</p>
									<p><strong>NÃ¤chster Schritt:</strong> â†’ Zur Freigabe oder â†’ Archiviert</p>
									<p>
										<strong>Beschreibung:</strong> Hier werden neue WÃ¼nsche geschrieben und bestehende
										Ã¼berarbeitet. Der Inhalt kann beliebig oft geÃ¤ndert werden.
									</p>
								</div>
							</div>
						</div>

						<!-- Step 2: Zur Freigabe -->
						<div class="card bg-base-100 border-info/20 border">
							<div class="card-body">
								<div class="mb-2 flex items-center gap-3">
									<div class="badge badge-info">2</div>
									<h5 class="text-info font-bold">â³ Zur Freigabe</h5>
								</div>
								<p class="mb-3 text-sm"><strong>Zweck:</strong> QualitÃ¤tsprÃ¼fung und Genehmigung</p>
								<div class="space-y-1 text-sm">
									<p>
										<strong>Berechtigung:</strong> Redakteure kÃ¶nnen einreichen, Administratoren genehmigen
									</p>
									<p><strong>Aktionen:</strong> PrÃ¼fung auf QualitÃ¤t, Grammatik, Angemessenheit</p>
									<p>
										<strong>NÃ¤chster Schritt:</strong> â†’ Freigegeben, â†’ Entwurf (zurÃ¼ck) oder â†’ Archiviert
									</p>
									<p>
										<strong>Beschreibung:</strong> Administratoren prÃ¼fen eingereichte WÃ¼nsche und entscheiden
										Ã¼ber deren Freigabe.
									</p>
								</div>
							</div>
						</div>

						<!-- Step 3: Freigegeben -->
						<div class="card bg-base-100 border-success/20 border">
							<div class="card-body">
								<div class="mb-2 flex items-center gap-3">
									<div class="badge badge-success">3</div>
									<h5 class="text-success font-bold">âœ… Freigegeben</h5>
								</div>
								<p class="mb-3 text-sm">
									<strong>Zweck:</strong> QualitÃ¤tsgeprÃ¼fte WÃ¼nsche bereit fÃ¼r Release
								</p>
								<div class="space-y-1 text-sm">
									<p><strong>Berechtigung:</strong> Nur Administratoren kÃ¶nnen freigeben</p>
									<p><strong>Aktionen:</strong> Release fÃ¼r WishSnap mÃ¶glich</p>
									<p><strong>NÃ¤chster Schritt:</strong> â†’ Released (WishSnap) oder â†’ Archiviert</p>
									<p>
										<strong>Beschreibung:</strong> Freigegebene WÃ¼nsche sind qualitÃ¤tsgeprÃ¼ft und kÃ¶nnen
										fÃ¼r die Ã¶ffentliche WishSnap-App released werden.
									</p>
								</div>
							</div>
						</div>

						<!-- Step 4: Released -->
						<div class="card bg-base-100 border-accent/20 border">
							<div class="card-body">
								<div class="mb-2 flex items-center gap-3">
									<div class="badge badge-accent">4</div>
									<h5 class="text-accent font-bold">ğŸš€ Released</h5>
								</div>
								<p class="mb-3 text-sm">
									<strong>Zweck:</strong> Ã–ffentliche VerfÃ¼gbarkeit in WishSnap-App
								</p>
								<div class="space-y-1 text-sm">
									<p><strong>Berechtigung:</strong> Administratoren & Redakteure kÃ¶nnen releasen</p>
									<p>
										<strong>Aktionen:</strong> Snapshot in separate Tabelle, Ã¶ffentlicher API-Zugriff
									</p>
									<p>
										<strong>API:</strong> VerfÃ¼gbar Ã¼ber /api/public/wishes (ohne Authentifizierung)
									</p>
									<p>
										<strong>Beschreibung:</strong> Released Wishes sind Ã¶ffentlich verfÃ¼gbar und kÃ¶nnen
										von der WishSnap-App heruntergeladen werden.
									</p>
								</div>
							</div>
						</div>

						<!-- Step 5: Archiviert -->
						<div class="card bg-base-100 border-neutral/20 border">
							<div class="card-body">
								<div class="mb-2 flex items-center gap-3">
									<div class="badge badge-ghost">A</div>
									<h5 class="text-neutral font-bold">ğŸ“ Archiviert</h5>
								</div>
								<p class="mb-3 text-sm"><strong>Zweck:</strong> Inaktivierung ohne LÃ¶schung</p>
								<div class="space-y-1 text-sm">
									<p><strong>Berechtigung:</strong> Nur Administratoren</p>
									<p><strong>Aktionen:</strong> Reaktivierung mÃ¶glich (â†’ Entwurf)</p>
									<p>
										<strong>Verwendung:</strong> QualitÃ¤tskontrolle, veraltete/ungeeignete Inhalte
									</p>
									<p>
										<strong>Beschreibung:</strong> Archivierte WÃ¼nsche sind inaktiv, aber nicht gelÃ¶scht.
										Sie kÃ¶nnen reaktiviert werden.
									</p>
								</div>
							</div>
						</div>
					</div>

					<!-- Roles & Permissions -->
					<div class="space-y-4">
						<h4 class="border-base-300 border-b pb-2 text-lg font-semibold">
							ğŸ‘¥ Rollen & Berechtigungen
						</h4>

						<div class="grid grid-cols-1 gap-4 md:grid-cols-2">
							<!-- Redakteur -->
							<div class="card bg-primary/5 border-primary/20 border">
								<div class="card-body">
									<h5 class="text-primary flex items-center gap-2 font-bold">
										<span class="badge badge-primary badge-xs">Redakteur</span>
										Standard-Benutzer
									</h5>
									<ul class="mt-2 space-y-1 text-sm">
										<li>âœ… WÃ¼nsche erstellen (Entwurf)</li>
										<li>âœ… Eigene WÃ¼nsche bearbeiten</li>
										<li>âœ… Zur Freigabe einreichen</li>
										<li>âœ… WÃ¼nsche fÃ¼r WishSnap releasen</li>
										<li>âŒ WÃ¼nsche freigeben</li>
										<li>âŒ WÃ¼nsche archivieren</li>
										<li>âŒ Fremde EntwÃ¼rfe bearbeiten</li>
									</ul>
								</div>
							</div>

							<!-- Administrator -->
							<div class="card bg-error/5 border-error/20 border">
								<div class="card-body">
									<h5 class="text-error flex items-center gap-2 font-bold">
										<span class="badge badge-error badge-xs">Administrator</span>
										Vollzugriff
									</h5>
									<ul class="mt-2 space-y-1 text-sm">
										<li>âœ… Alle Redakteur-Rechte</li>
										<li>âœ… WÃ¼nsche freigeben/ablehnen</li>
										<li>âœ… WÃ¼nsche archivieren</li>
										<li>âœ… Archivierte reaktivieren</li>
										<li>âœ… Alle WÃ¼nsche bearbeiten</li>
										<li>âœ… Benutzer verwalten</li>
										<li>âœ… System-Einstellungen</li>
									</ul>
								</div>
							</div>
						</div>
					</div>

					<!-- WishSnap Integration -->
					<div class="space-y-4">
						<h4 class="border-base-300 border-b pb-2 text-lg font-semibold">
							ğŸ“± WishSnap Integration
						</h4>

						<div class="alert alert-success">
							<svg
								xmlns="http://www.w3.org/2000/svg"
								fill="none"
								viewBox="0 0 24 24"
								class="h-6 w-6 shrink-0 stroke-current"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="2"
									d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
								></path>
							</svg>
							<div class="text-sm">
								<h5 class="font-bold">Ã–ffentliche API:</h5>
								<p><strong>Endpoint:</strong> /api/public/wishes</p>
								<p><strong>Zugriff:</strong> Ohne Authentifizierung (Ã¶ffentlich)</p>
								<p><strong>Inhalt:</strong> Nur released Wishes (Snapshot-Daten)</p>
								<p><strong>Verwendung:</strong> WishSnap-App lÃ¤dt WÃ¼nsche fÃ¼r Offline-Nutzung</p>
							</div>
						</div>
					</div>

					<!-- Best Practices -->
					<div class="space-y-4">
						<h4 class="border-base-300 border-b pb-2 text-lg font-semibold">ğŸ’¡ Best Practices</h4>

						<div class="grid grid-cols-1 gap-4 md:grid-cols-2">
							<div>
								<h5 class="text-success mb-2 font-semibold">âœ… Empfohlenes Vorgehen:</h5>
								<ul class="space-y-1 text-sm">
									<li>â€¢ WÃ¼nsche in Entwurf sorgfÃ¤ltig prÃ¼fen</li>
									<li>â€¢ Klare, verstÃ¤ndliche Sprache verwenden</li>
									<li>â€¢ Platzhalter korrekt einsetzen</li>
									<li>â€¢ Angemessene Kategorisierung</li>
									<li>â€¢ Release nur nach QualitÃ¤tsprÃ¼fung</li>
								</ul>
							</div>
							<div>
								<h5 class="text-error mb-2 font-semibold">âŒ Zu vermeiden:</h5>
								<ul class="space-y-1 text-sm">
									<li>â€¢ Rechtschreibfehler in freigegebenen WÃ¼nschen</li>
									<li>â€¢ Unpassende/verletzende Inhalte</li>
									<li>â€¢ Zu generische oder zu spezifische WÃ¼nsche</li>
									<li>â€¢ Release ohne ausreichende PrÃ¼fung</li>
									<li>â€¢ HÃ¤ufige Status-Wechsel</li>
								</ul>
							</div>
						</div>
					</div>
				{/if}
			</div>

			<div class="modal-action">
				<button class="btn btn-primary" onclick={closeModal}>Verstanden</button>
			</div>
		</div>
	</div>
{/if}
